<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="http://localhost:4000/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Historical Biogeographic Analysis using an epoch DEC Model</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/software">Software</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/developer/">Developer</a></li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Historical Biogeographic Analysis using an epoch DEC Model</h1>
	<h3 class="subtitle">Ancestral range estimation of the silverswords under the dispersal-extinction-cladogenesis process</h3>
	<h4 class="authors">Michael J. Landis</h4>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/biogeo/biogeo_intro.html">Introduction to Historical Biogeography</a></li>
          
            <li><a href="/tutorials/biogeo/biogeo_simple.html">Historical Biogeographic Analysis using a Simple DEC Model</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





<blockquote class="tutorial_files" id="tutorial_files">
    <h2>Data files and scripts</h2>
    
        
        <strong>Data Files</strong>
        <ul id="data_files">
        
        
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.connectivity.1.txt">hawaii.n4.connectivity.1.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.connectivity.2.txt">hawaii.n4.connectivity.2.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.connectivity.3.txt">hawaii.n4.connectivity.3.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.connectivity.4.txt">hawaii.n4.connectivity.4.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.distances.txt">hawaii.n4.distances.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/hawaii.n4.times.txt">hawaii.n4.times.txt</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/silversword.n4.range.nex">silversword.n4.range.nex</a></li>
        
          <li><a href="/tutorials/biogeo/data/n4/silversword.tre">silversword.tre</a></li>
        
        </ul>
    
        
        <strong>Scripts</strong>
        <ul id="scripts">
        
        
        
          <li><a href="/tutorials/biogeo/scripts/make_anc_state.Rev">make_anc_state.Rev</a></li>
        
          <li><a href="/tutorials/biogeo/scripts/plot_anc_range.epoch.R">plot_anc_range.epoch.R</a></li>
        
          <li><a href="/tutorials/biogeo/scripts/run_epoch.Rev">run_epoch.Rev</a></li>
        
        </ul>
    
</blockquote>


</div>
<h2 class="section" id="intro">Introduction</h2>
<hr class="section" />

<p>In the <a href="/tutorials/biogeo/biogeo_simple.html">Historical Biogeographic Analysis using a Simple DEC Model</a> tutorial, we went through the exercise of setting up the
instantaneous rate matrix and cladogenetic transition probabilities for a simple 
DEC model.
In this tutorial, we will set up a more complex model considering the geological histories in the biogeographic inference. We will learn how to set up an epoch model.</p>

<h2 class="section" id="bg_epoch">An improved DEC analysis</h2>
<hr class="section" />

<p>In this section, we’ll introduce a suite of model features that lend
towards more realistic biogeographic analyses. Topics include applying
range size constraints, stratified (or epoch) models of
paleoconnectivity, function-valued dispersal rates, and incorporating
uncertainty in paleogeographic event time estimates. These modifications
should produce more realistic ancestral range estimates, e.g. that a
volcanic island may only be colonized once it has formed, and that
distance should have some bearing on dispersal rate.</p>

<p>To accomplish this, we’ll incorporate (paleo-)geographical data for the
Hawaiian archipelago, summarized in Table [tab:paleogeo]. Even though
we will continue to use four areas (K, O, M, H) in this section, we will
use all six areas (R, K, O, M, H, Z) in <a href="#bg_phylo"></a>, hence
the full table is given for future reference.</p>

<table>
  <thead>
    <tr>
      <th>area</th>
      <th>code</th>
      <th>$a_{max}$</th>
      <th>$a_{min}$</th>
      <th>$g_{\bullet R}$</th>
      <th>$g_{\bullet K}$</th>
      <th>$g_{\bullet O}$</th>
      <th>$g_{\bullet M}$</th>
      <th>$g_{\bullet H}$</th>
      <th>$g_{\bullet Z}$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Older islands</td>
      <td>R</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>261</td>
      <td>406</td>
      <td>500</td>
      <td>680</td>
      <td>3900</td>
    </tr>
    <tr>
      <td>Kauai</td>
      <td>K</td>
      <td>5.15</td>
      <td>5.05</td>
      <td>-</td>
      <td>-</td>
      <td>145</td>
      <td>239</td>
      <td>419</td>
      <td>3900</td>
    </tr>
    <tr>
      <td>Oahu</td>
      <td>O</td>
      <td>3.7</td>
      <td>2.2</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>059</td>
      <td>239</td>
      <td>3900</td>
    </tr>
    <tr>
      <td>Maui Nui</td>
      <td>M</td>
      <td>1.8</td>
      <td>1.3</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>082</td>
      <td>3900</td>
    </tr>
    <tr>
      <td>Hawaii</td>
      <td>H</td>
      <td>0.7</td>
      <td>0.3</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>3900</td>
    </tr>
    <tr>
      <td>Mainland</td>
      <td>Z</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<p>: Hawaiian paleogeographic data. The six areas are given in <a href="#hawaii_areas"></a>.
   Ages $a_{max}$ and $a_{min}$ report the maximum
  and minimum origination times for the given island [adapted from
  (missing reference)]. Distances $g_{ij}$ report the shortest geographical
  distance from the coast of the row’s area to the column’s area
  (measured at present).<span data-label="tab:paleogeo"></span></p>

<h3 class="subsection" id="analysis">Analysis</h3>
<hr class="subsection" />

<p>Start by creating variables for the tree file, the range data, and the
output prefix</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>range_fn = "data/n4/silversword.n4.range.nex"
tree_fn = "data/n4/silversword.tre"
out_fn = "output/epoch"
</code></pre></div></div>

<p>The paleogeographical information from Table [tab:paleogeo] is encoded
in three files named <code class="highlighter-rouge">hawaii.n4.times.txt</code>,
<code class="highlighter-rouge">hawaii.n4.distances.txt</code>, and
<code class="highlighter-rouge">hawaii.n4.connectivity.\*.txt</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>geo_fn = "data/n4/hawaii.n4"
times_fn = geo_fn + ".times.txt"
dist_fn = geo_fn + ".distances.txt"
</code></pre></div></div>

<p>Create move index (mvi) and monitor index
(mni) variables to populate the elements of our
moves and monitors vectors, respectively.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvi = 1
mni = 1
</code></pre></div></div>

<p>Read in the presence-absence range characters and record the number of
areas in the dataset</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dat_range_01 = readDiscreteCharacterData(range_fn)
n_areas &lt;- dat_range_01.nchar()
</code></pre></div></div>

<p>Often, biogeographers wish to limit to the maximum allowable range size.
This prohibits widespread species ranges and reduces the total number of
range states in the analysis, thus improving computational efficiency.
We will restrict ranges from including more than two areas. The total
number of ranges equals $\sum_{k=0}^m {n \choose k}$ where $n$ is the
total number of areas, $m$ is the maximum number of permissible areas,
and ${n}\choose{k}$ is the number of ways to sample $k$ unordered
areas from a pool of $n$ areas. For $n=4$ and $m=2$, this equals
${4 \choose 0} + {4 \choose 1} + {4 \choose 2} = 1 + 4 + 6 = 11$
states.</p>

<p>First, compute the number of states</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>max_areas &lt;- 2
n_states &lt;- 0
for (k in 0:max_areas) n_states += choose(n_areas, k)
</code></pre></div></div>

<p>then use n_states to format the dataset for the reduced
state space</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dat_range_n = formatDiscreteCharacterData(dat_range_01, "DEC", n_states)
</code></pre></div></div>

<p>Our state space now includes only 11 states ($\emptyset$, K, O, M, H,
KO, KM, OM, KH, OH, MH).</p>

<p>Record the complete list of range descriptions to file</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>state_desc = dat_range_n.getStateDescriptions()
state_desc_str = "state,range\n"
for (i in 1:state_desc.size())
{
    state_desc_str += (i-1) + "," + state_desc[i] + "\n"
}
write(state_desc_str, file=out_fn+".state_labels.txt")
</code></pre></div></div>

<p>As with the previous analysis, we’ll brazenly assume we know the dated
species phylogeny without error.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tree &lt;- readTrees(tree_fn)[1]
</code></pre></div></div>

<p>Next, we’ll read and structure our paleogeographic data. Read in the
list of minimum and maximum ages of island formation</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>time_bounds &lt;- readDataDelimitedFile(file=times_fn, delimiter=" ")
n_epochs &lt;- time_bounds.size()
</code></pre></div></div>

<p>Read in the vector of matrices that describe the connectivity between
areas over time. Note, there is one connectivity matrix per epoch,
ordered from oldest to youngest.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:n_epochs) {
  epoch_fn[i] = geo_fn + ".connectivity." + i + ".txt"
  connectivity[i] &lt;- readDataDelimitedFile(file=epoch_fn[i], delimiter=" ")
}
</code></pre></div></div>

<p>The area connectivity file for the third epoch (when K, O, and M exist,
but not H) contains</p>

<div class="rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    1 1 1 0
    1 1 1 0
    1 1 1 0
    0 0 0 0
</code></pre></div></div>

<p>Dispersal events between, say, K and M will be penalized by distance
rather than be forbidden by non-connectivity.</p>

<p>Read in the matrix of distances between all pairs of areas (km). For
simplicity, we will assume that distances remained constant across
epochs, even though these distances certainly varied over time.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>distances &lt;- readDataDelimitedFile(file=dist_fn, delimiter=" ")
</code></pre></div></div>

<p>The distances files contains</p>

<div class="rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    001 145 239 419
    145 001 059 239
    239 059 001 082
    419 239 082 001
</code></pre></div></div>

<p>and, if we assume the relative distance between islands remains roughly
constant over time, then one set of distances is suitable for use for
all four epochs.</p>

<p>Next, we’ll build an enhanced DEC model. Like before, we’ll define the
rate matrix in terms of relative rates, then rescale the entire matrix
with the biogeographic rate scaling parameter <code class="highlighter-rouge">rate_bg</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log10_rate_bg ~ dnUniform(-4,2)
log10_rate_bg.setValue(-2)
rate_bg := 10^log10_rate_bg
moves[mvi++] = mvSlide(log10_rate_bg, weight=4)
</code></pre></div></div>

<p>Fix the base dispersal rate to 1</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dispersal_rate &lt;- 1.0
</code></pre></div></div>

<p>Dispersal rates might make use of some extrinsic information, such as
geographical distances between areas <a href="#MacArthur1967">(MacArthur and Wilson 1967; Webb and Ree 2012)</a>. We
model this as $d_{ij} = \exp(-a g_{ij})$ where $g_{ij}$ is the
geographical distance between areas $i$ and $j$ and $a$ is a parameter
that scales distance. Note that all dispersal rates are equal when
$a=0$. Add a distance scale parameter</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>distance_scale ~ dnUnif(0,20)
distance_scale.setValue(0.01)
moves[mvi++] = mvScale(distance_scale, weight=3)
</code></pre></div></div>

<p>Now we can assign rates that are functions of distance between all pairs
of areas, <em>but also over all epochs</em>. To accomplish this,
notice we now have an outer loop over the number of epochs,
n_epochs. This is used to construct a vector of dispersal
matrices, one matrix per epoch. It is crucial to note that all of
elements are assigned the value 0.0 unless the if-statement
<code class="highlighter-rouge">if (connectivity[i][j][k] &amp;gt; 0)</code>  evaluates to
true. That is, dispersal rates between areas j
and k for epoch i are non-zero if and only if
the connectivity matrix element <code class="highlighter-rouge">connectivity[i][j][k]</code>
has a positive value! When this condition is met, the dispersal rate is
determined by the exponential function of inverse distance given above.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:n_epochs) {
  for (j in 1:n_areas) {
    for (k in 1:n_areas) {
      dr[i][j][k] &lt;- 0.0
      if (connectivity[i][j][k] &gt; 0) {
        dr[i][j][k]  := dispersal_rate * exp(-distance_scale * distances[j][k])
      }
    }
  }
}
</code></pre></div></div>

<p>We will assign the same extirpation prior as was done in the simple
analysis in the previous section</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log_sd &lt;- 0.5
log_mean &lt;- ln(1) - 0.5*log_sd^2
extirpation_rate ~ dnLognormal(mean=log_mean, sd=log_sd)
moves[mvi++] = mvScale(extirpation_rate, weight=2)
</code></pre></div></div>

<p>and then provide the appropriate extirpation matrix structure</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:n_epochs) {
  for (j in 1:n_areas) {
    for (k in 1:n_areas) {
      er[i][j][k] &lt;- 0.0
    }
    er[i][j][j] := extirpation_rate
  }
}
</code></pre></div></div>

<p>Now we have a vector of dispersal rates, dr, and an vector
of extirpation rates, er, in stored in the RevBayes
workspace. We’ll use these to create a vector of four DEC rate matrices,
one for each epoch.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:n_epochs) {
  Q_DEC[i] := fnDECRateMatrix(dispersalRates=dr[i],
                              extirpationRates=er[i],
                              maxRangeSize=max_areas)
}
</code></pre></div></div>

<p>Next, we need to define breakpoints for when the underlying
paleogeographic state/connectivity changes. In our case, we’ll define
the epoch breakpoints as uniformly distributed random variables that are
bounded by the minimum and maximum age estimates for when each new
island complex formed (Table [tab:paleogeo]). This is easily done
using a for loop over the number of epochs. Note, we define the end of
the final epoch as the present.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:n_epochs) {
  time_max[i] &lt;- time_bounds[i][1]
  time_min[i] &lt;- time_bounds[i][2]
  if (i != n_epochs) {
      epoch_times[i] ~ dnUniform(time_min[i], time_max[i])
      moves[mvi++] = mvSlide(epoch_times[i], delta=(time_max[i]-time_min[i])/2)
  } else {
      epoch_times[i] &lt;- 0.0
  }
}
</code></pre></div></div>

<p>Now that we have variables for the timing (<code class="highlighter-rouge">epoch_times</code>)
and character (<code class="highlighter-rouge">Q_DEC</code> via connectivity) of
paleogeographic change throughout the Hawaiian archipelago, we’re ready
to unify these objects with the fnEpoch function. This
function requires a vector of rate matrices, a vector of epoch end
times, and a vector of rate multipliers as arguments. Internally, the
function computes the appropriate probabilities for state transitions
along branches according under a piecewise constant continuous-time
Markov chain. The important consequence of using an epoch model is that
transition probabilities for anagenetic events depend on the geological
age of the branch.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q_DEC_epoch := fnEpoch(Q=Q_DEC, times=epoch_times, rates=rep(1,n_epochs))
</code></pre></div></div>

<p>Here, we treat the probability of different types of cladogenetic events
as a random variables to be estimated.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>clado_event_types &lt;- [ "s", "a" ]
p_sympatry ~ dnUniform(0,1)
p_allopatry := abs(1.0 - p_sympatry)
clado_type_probs := simplex(p_sympatry, p_allopatry)
moves[mvi++] = mvSlide(p_sympatry, weight=2)
P_DEC := fnDECCladoProbs(eventProbs=clado_type_probs,
                         eventTypes=clado_event_types,
                         numCharacters=n_areas,
                         maxRangeSize=max_areas)
</code></pre></div></div>

<p>For this dataset, we assume cladogenetic probabilities are constant with
respect to geological time. Using time-dependent cladogenetic
probabilities (<code class="highlighter-rouge">fnEpochCladoProbs</code>) and mixtures of
cladogenetic probabilities (<code class="highlighter-rouge">fnMixtureCladoProbs</code>) will be
covered in future tutorials.</p>

<p>Among the four areas, only Kauai existed at the provided origination
time of the clade, so will set it as the only valid starting state
through the root frequency distribution.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rf_DEC &lt;- rep(0, n_states)
rf_DEC[2] &lt;- 1 
rf_DEC &lt;- simplex(rf_DEC)
</code></pre></div></div>

<p>We have created all the necessary model variables. Now we can create the
phylogenetic model of anagenetic and cladogenetic character evolution.
<code class="highlighter-rouge">dnPhyloCTMCClado</code> will internally make use of the
time-heterogeneous probabilities embedded in the epoch rate generator,
<code class="highlighter-rouge">Q_DEC_epoch</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m_bg ~ dnPhyloCTMCClado(tree=tree,
                        Q=Q_DEC_epoch,
                        cladoProbs=P_DEC,
                        branchRates=rate_bg,
                        rootFrequencies=rf_DEC,
                        type="NaturalNumbers",
                        nSites=1)
</code></pre></div></div>

<p>Attach the observed range data to the distribution</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m_bg.clamp(dat_range_n)
</code></pre></div></div>

<p>And the rest we’ve done before…</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>monitors[mni++] = mnScreen(printgen=100, rate_bg, extirpation_rate, distance_scale)
monitors[mni++] = mnModel(file=out_fn+".model.log", printgen=10)
monitors[mni++] = mnFile(tree, filename=out_fn+".tre", printgen=10)
monitors[mni++] = mnJointConditionalAncestralState(tree=tree,
                                                       ctmc=m_bg,
                                                       type="NaturalNumbers",
                                                       withTips=true,
                                                       withStartStates=true,
                                                       filename=out_fn+".states.log",
                                                       printgen=10)
</code></pre></div></div>

<p>Wrap the model graph into a model object</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymodel = model(m_bg)
</code></pre></div></div>

<p>then build and run MCMC</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymcmc = mcmc(mymodel, moves, monitors)
mymcmc.run(5000)
</code></pre></div></div>

<h3 class="subsection" id="results">Results</h3>
<hr class="subsection" />

<p><strong>Example results are located at <code class="highlighter-rouge">output_example/epoch</code>.</strong></p>

<p>When compared to the ancestral state estimates from the “simple”
analysis (<a href="#simple_RevGadgets_ase"></a>), these results are far
more consonant with what we understand about the origination times of
the islands (Table [tab:paleogeo]). First, this reconstruction asserts
that the clade originated in the modern Hawaiian islands at a time when
only Kauai was above sea level. Similarly, the <em>D.
sheriffiana</em> and <em>D. arborea</em> clade no longer
estimates OMH as its ancestral range, since Maui and Hawaii had not yet
formed 2.4 Ma. The ancestral range for the <em>Agyroxiphium</em>
clade is Maui (M) with probability 0.41 and Maui+Hawaii (MH) with
probability 0.33, whereas previously it gave high support to the range
KMH.</p>

<p>It may be that these are relatively accurate historical biogeographic
estimates, or they may contain artifacts as a result of assuming a fixed
and errorless phylogeny. The next tutorials discuss how to jointly
estimate phylogeny and biogeography, which potentially improves the
estimation of divergence times, tree topology, and ancestral ranges.</p>

<figure id="epoch_RevGadgets_ase"><p><img src="figures/fig_epoch_RevGadgets_ase.png" alt="" /></p>
<figcaption>Tree with ancestral
state estimates. Nodes are annotated with ancestral states before and
after cladogenetic events. Most probable states are shown. Colors of
markers indicate the range state. Sizes of markers indicate the
posterior probability of that state.</figcaption>
</figure>

<ol class="bibliography"><li><span id="MacArthur1967">MacArthur R.H., Wilson E.O. 1967. Theory of Island Biogeography. Princeton University Press.</span>

<a href="https://doi.org/10.1515/9781400881376">10.1515/9781400881376</a>

</li>
<li><span id="Webb2012">Webb C.O., Ree R.H. 2012. Historical biogeography inference in Malesia. Biotic evolution and environmental change in Southeast Asia.:191–215.</span>

<a href="https://doi.org/10.1017/CBO9780511735882.010">10.1017/CBO9780511735882.010</a>

</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>

<script src="/assets/js/base.js"></script>

<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>

  </body>
</html>
