<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Introduction to MCMC</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/download">Download</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/documentation/">Documentation</a></li>
        <li><a href="https://revbayes.github.io/revscripter/">RevScripter</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
        <li><<a href="/gui">GUI</a></li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Introduction to MCMC</h1>
	<h3 class="subtitle">A simple Poisson regression example</h3>
	<h4 class="authors">Sebastian H&#246;hna</h4>
  <h5>Last modified on April  8, 2020</h5>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/intro/">Getting Started with RevBayes and Rev Language Syntax</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





</div>
<h1 id="exercise-poisson-regression-model-for-airline-fatalities">Exercise: Poisson Regression Model for Airline Fatalities</h1>

<p>This exercise will demonstrate how to approximate the posterior
distribution of some parameters using a simple Metropolis algorithm. The
focus here lies in the Metropolis algorithm, Bayesian inference, and
model specification—but not in the model or the data. After completing
this computer exercise, you should be familiar with the basic Metropolis
algorithm, analyzing output generated from a MCMC algorithm, and
performing standard Bayesian inference.</p>

<h2 id="model-and-data">Model and Data</h2>

<p>We will use the data example from <a class="citation" href="#Gelman2003">Gelman et al. (2003)</a>. A summary is given in
<a href="#airlineFatalities"></a>.</p>

<figure id="airlineFatalities" class="table"><table>
  <thead>
    <tr>
      <th>Year</th>
      <th style="text-align: right">1976</th>
      <th style="text-align: right">1977</th>
      <th style="text-align: right">1978</th>
      <th style="text-align: right">1979</th>
      <th style="text-align: right">1980</th>
      <th style="text-align: right">1981</th>
      <th style="text-align: right">1982</th>
      <th style="text-align: right">1983</th>
      <th style="text-align: right">1984</th>
      <th style="text-align: right">1985</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Fatalities</td>
      <td style="text-align: right">24</td>
      <td style="text-align: right">25</td>
      <td style="text-align: right">31</td>
      <td style="text-align: right">31</td>
      <td style="text-align: right">22</td>
      <td style="text-align: right">21</td>
      <td style="text-align: right">26</td>
      <td style="text-align: right">20</td>
      <td style="text-align: right">16</td>
      <td style="text-align: right">22</td>
    </tr>
  </tbody>
</table>

<figcaption class="table">Airline fatalities from 1976 to 1985. Reproduced from <a class="citation" href="#Gelman2003">Gelman et al. (2003)</a> [Table 2.2 on p. 69].</figcaption>
</figure>

<p>These data can be loaded into <code class="language-plaintext highlighter-rouge">RevBayes</code> by typing:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>observed_fatalities &lt;- v(24,25,31,31,22,21,26,20,16,22)
</code></pre></div></div>

<p>The model is a <a href="http://en.wikipedia.org/wiki/Poisson_regression">Poisson
regression</a> model with
parameters $\alpha$ and $\beta$</p>

\[y \sim \text{Poisson}(\exp(\alpha+\beta*x))\]

<p>where $y$ is the number of fatal accidents in year $x$. For simplicity,
we choose uniform priors for $\alpha$ and $\beta$.</p>

\[\begin{aligned}
\alpha &amp; \sim \text{Uniform}(-10,10)\\
\beta &amp;  \sim \text{Uniform}(-10,10)\end{aligned}\]

<p>The probability density can be computed in <code class="language-plaintext highlighter-rouge">RevBayes</code> for a single year by</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dpoisson(y[i],exp(alpha+beta*x[i]))
</code></pre></div></div>

<h2 id="problems">Problems</h2>

<h3 id="metropolis-algorithm">Metropolis Algorithm</h3>

<p>The source file for this sub-exercise ‘airline_fatalities_part1.Rev‘.</p>

<p>Let us construct a Metropolis algorithm that simulates from the
posterior distribution $P(\alpha,\beta|y)$. We will construct this
algorithm explicitly, without using the high-level functions existing in
<code class="language-plaintext highlighter-rouge">RevBayes</code> to perform MCMC. In the next section, we will repeat the same
analysis, this time using the high-level functions. (More background on
MCMC is provided in the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_MCMC_Intro_Tutorial/RB_MCMC_Intro_Tutorial.pdf">Introduction to Markov Chain Monte Carlo
Algorithms
tutorial</a>.)</p>

<p>For simplicity of the calculations you can “normalize” the years, e.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x &lt;- 1976:1985 - mean(1976:1985)
</code></pre></div></div>

<p>A common proposal distribution for $\alpha^{\prime} \sim P(\alpha[i-1])$
is the normal distribution with mean $\mu = \alpha[i-1]$ and standard
deviation $\sigma = \delta_\alpha$:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alpha_prime &lt;- rnorm(1,alpha[i-1],delta_alpha)
</code></pre></div></div>

<p>A similar distribution should be used for $\beta^{\prime}$.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>delta_alpha &lt;- 1.0
delta_beta &lt;- 1.0
</code></pre></div></div>

<p>After you look at the output of the MCMC (later), play around to find
appropriate values for $\delta_{\alpha}$ and $\delta_{\beta}$.</p>

<p>Now we need to set starting values for the MCMC algorithm. Usually,
these are drawn from the prior distribution, but sometimes if the prior
is very uninformative, then these parameter values result in a
likelihood of 0.0 (or log-likelihood of -Inf).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alpha[1] &lt;- -0.01     # you can also use runif(-1.0,1.0)
beta[1] &lt;- -0.01      # you can also use runif(-1.0,1.0)
</code></pre></div></div>

<p>Next, create some output for our MCMC algorithm. The output will be
written into a file that can be read into <code class="language-plaintext highlighter-rouge">R</code>or Tracer
<a class="citation" href="#Rambaut2011">(Rambaut and Drummond 2011)</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># create a file output
write("iteration","alpha","beta",file="airline_fatalities.log")
write(0,alpha[1],beta[1],file="airline_fatalities.log",append=TRUE)
</code></pre></div></div>

<p>Note that we need a first iteration with value 0 so that Tracer can load
in this file.</p>

<p>Finally, we set up a ‘for‘ loop over each iteration of the MCMC.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 2:10000) {
</code></pre></div></div>

<p>Within the ‘for‘ loop we propose new parameter values.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    alpha_prime &lt;- rnorm(1,alpha[i-1],delta_alpha)[1]
    beta_prime &lt;- rnorm(1,beta[i-1],delta_beta)[1]
</code></pre></div></div>

<p>For the newly proposed parameter values we compute the prior ratio. In
this case we know that the prior ratio is 0.0 as long as the new
parameters are within the limits.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    ln_prior_ratio &lt;- dunif(alpha_prime,-10.0,10.0,log=TRUE) + dunif(beta_prime,-10.0,10.0,log=TRUE) - dunif(alpha[i-1],-10.0,10.0,log=TRUE) - dunif(beta[i-1],-10.0,10.0,log=TRUE)
</code></pre></div></div>

<p>Similarly, we compute the likelihood ratio for each observation.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    ln_likelihood_ratio &lt;- 0
    for (j in 1:x.size() ) {
       lambda_prime &lt;- exp( alpha_prime + beta_prime * x[j] )
       lambda &lt;- exp( alpha[i-1] + beta[i-1] * x[j] )
       ln_likelihood_ratio += dpoisson(observed_fatalities[j],lambda_prime) - dpoisson(observed_fatalities[j],lambda)
    }
    ratio &lt;- ln_prior_ratio + ln_likelihood_ratio
</code></pre></div></div>

<p>And finally we accept or reject the newly proposed parameter values with
probability ‘ratio‘.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    if ( ln(runif(1)[1]) &lt; ratio) {
       alpha[i] &lt;- alpha_prime
       beta[i] &lt;- beta_prime
    } else {
       alpha[i] &lt;- alpha[i-1]
       beta[i] &lt;- beta[i-1]
    }
</code></pre></div></div>

<p>Then we log the current parameter values to the file by appending the
file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    # output to a log-file
    write(i-1,alpha[i],beta[i],file="airline_fatalities.log",append=TRUE)
 }
</code></pre></div></div>

<p>As a quick summary you can compute the posterior mean of the parameters.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mean(alpha)
mean(beta)
</code></pre></div></div>

<p>You can also load the file into <code class="language-plaintext highlighter-rouge">R</code>or Tracer to analyze the
output.</p>

<p>In this section of the first exercise we wrote our own little Metropolis
algorithm in <code class="language-plaintext highlighter-rouge">Rev</code>. This becomes very cumbersome, difficult and slow if
we’ld need to do this for every model. Here we wanted to show you only
the basic principle of any MCMC algorithm. In the next section we will
use the built-in MCMC algorithm of <code class="language-plaintext highlighter-rouge">RevBayes</code>.</p>

<h3 id="mcmc-analysis-using-the-built-in-algorithm-in-revbayes">MCMC analysis using the built-in algorithm in <code class="language-plaintext highlighter-rouge">RevBayes</code></h3>

<p>Before starting with this new approach it would be good if you either
start a new <code class="language-plaintext highlighter-rouge">RevBayes</code> session or clear all previous variables using the
‘clear‘ function. Currently we may have some minor memory problems and
if you get stuck it may help to restart <code class="language-plaintext highlighter-rouge">RevBayes</code>.</p>

<p>We start by loading in the data to <code class="language-plaintext highlighter-rouge">RevBayes</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>observed_fatalities &lt;- v(24,25,31,31,22,21,26,20,16,22)
x &lt;- 1976:1985 - mean(1976:1985)
</code></pre></div></div>

<p>Then we create the parameters with their prior distributions.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alpha ~ dnUnif(-10,10) 
beta ~ dnUnif(-10,10)
</code></pre></div></div>

<p>It may be good to set some reasonable starting values especially if you
choose a very uninformative prior distribution. If by chance you had
starting values that gave a likelihood of -Inf, then <code class="language-plaintext highlighter-rouge">RevBayes</code> will try
several times to propose new starting values drawn from the prior
distribution.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let us use reasonable starting value
alpha.setValue(0.0)
beta.setValue(0.0)
</code></pre></div></div>

<p>Our next step is to set up the moves. Moves are algorithms that propose
new values and know how to reset the values if the proposals are
rejected. We use the same sliding window move as we implemented above by
ourselves.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mi &lt;- 0
moves[mi++] = mvSlide(alpha)
moves[mi++] = mvSlide(beta)
</code></pre></div></div>

<p>Then we set up the model. This means we create a stochastic variable for
each observation and clamp its value with the observed data.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:x.size() ) {
    lambda[i] := exp( alpha + beta * x[i] )
    y[i] ~ dnPoisson(lambda[i])
    y[i].clamp(observed_fatalities[i])
}
</code></pre></div></div>

<p>We can now create the model by pulling up the model graph from any
variable that is connected to our model graph.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymodel = model( alpha )
</code></pre></div></div>

<p>We also need some monitors that report the current values during the
MCMC run. We create two monitors, one printing all numeric non-constant
variables to a file and one printing some information to the screen.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>monitors[1] = mnModel(filename="output/airline_fatalities.log",printgen=10, separator = "	")
monitors[2] = mnScreen(printgen=10, alpha, beta)
</code></pre></div></div>

<p>Finally we create an MCMC object. The MCMC object takes in a model
object, the vector of monitors and the vector of moves.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymcmc = mcmc(mymodel, monitors, moves)
</code></pre></div></div>

<p>On the MCMC object we call its member method ‘run‘ to run the MCMC.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymcmc.run(generations=3000)
</code></pre></div></div>

<p>And now we are done</p>

<h3 id="posterior-distribution-of-alpha-and-beta">Posterior Distribution of $\alpha$ and $\beta$</h3>

<ul>
  <li>Report the posterior mean and 95% credible intervals for $\alpha$ and $\beta$.</li>
  <li>Additionally, plot the posterior distribution of $\alpha$ and $\beta$ by plotting a histogram of the samples.</li>
  <li>Plot the curve of \(m(x) = \text{E}[\exp(\alpha+\beta*x) |y]\) for $x = [1976,1985]$. You can generate draws from the posterior distribution of the expected value for
a specific $x$ by recording the current expected value at a iteration
$i$ of the Metropolis algorithm 
\(m_{sample}(x)[i] = \text{E}[\exp(\alpha[i]+\beta[i]*x) |y]\) and taking
the mean of those samples ($\bar{m}_{sample}(x)$) afterwards. Since <code class="language-plaintext highlighter-rouge">RevBayes</code>
provides you with the samples of
\(m(x) = \text{E}[\exp(\alpha+\beta*x) |y] = \lambda_x\) you can simply
plot these posterior curves.</li>
  <li>Produce a histogram of the predictive distribution of the number of
fatalities in 2014 and estimate the posterior mean. The predictive
distribution can be approximated simultaneously with the Metropolis
algorithm. This means, for any iteration $i$ you simulate draws from the
conditional distribution for $x = 2014$ and the current values of
$\alpha[i]$ and $\beta[i]$.</li>
  <li>Estimate the distribution of the mean of the posterior predictive
distribution of the number of fatalities in 2014.</li>
  <li>Let us denote the expected value of the posterior distribution by $\mu$. Since
we do not know this value $\mu$ exactly, we can follow the Bayesian
approach and associate a probability for each value $m$ as being the
true expected value of the posterior distribution, given the
observations $y$ ($P(m = \mu|y)$). You can approximate this distribution
by recording the expected value for the number of fatalities in 2014
($\text{E}[\exp(\alpha+\beta*x)|y]$) in each iteration $i$ of the
Metropolis algorithm. Plot a histogram of the expected values, compute
the mean of the expected values and compare it to the previously
obtained estimate of the mean of the posterior predictive distribution.</li>
  <li>Follow the same approach as for the posterior predictive distribution
for $x = 2014$, but this time for $x = 2016$ and estimate the
probability of no fatality.</li>
</ul>

<h1 id="exercise-poisson-regression-model-for-coal-mine-accidents">Exercise: Poisson Regression Model for Coal-mine Accidents</h1>

<p>We will analyze a dataset coal-mine accidents. The values are the dates
of major (more than 10 casualties) coal-mining disasters in the UK from
1851 to 1962.</p>

<h2 id="a-model-for-disasters">A model for disasters</h2>

<p>A common model for the number of events that occur over a period of time
is a Poisson process, in which the numbers of events in disjoint
time-intervals are independent and Poisson-distributed. We will
discretize and look at the yearly number of accidents.</p>

<p>In order to take into account the possible change of rate, we will allow
for different rates before and after year $\theta$, where $\theta$ is
unknown to us. Thus, the observation distribution of our model is
$y_t \sim Poisson(\lambda_t)$ with $t = 1851,\ldots,1962$ and
\(\begin{aligned}
\lambda_t = &amp; \begin{cases}
\beta &amp; \mbox{if } t &lt; \theta \\
\gamma &amp; \mbox{if } t \geq \theta
\end{cases}\end{aligned}\) Thus, the rate $\lambda_t$ is defined by
three unknown parameters: $\beta$, $\gamma$ and $\theta$. A hierarchical
choice of priors is given by \(\begin{aligned}
 \eta &amp; \sim Gamma(10.0;20.0) \\ 
 \beta &amp; \sim Gamma(2.0;\eta) \\
 \gamma &amp; \sim Gamma(2.0;\eta) \\
 \theta &amp; \sim Uniform(1852,\ldots,1962)\end{aligned}\) which brings
an additional parameter $\eta$ in the model. For $\theta$ we have used a
uniform prior over the years, but excluded year 1851 in order to make
sure at least one year has rate $\beta$. The hierarchical prior carries
the belief that $\beta$ and $\gamma$ are somewhat similar in size, since
they both depend on $\eta$.</p>

<h2 id="the-model-in-rev">The model in <code class="language-plaintext highlighter-rouge">Rev</code></h2>

<p>We start as usual by loading in the data.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>observed_fatalities &lt;-  v(4, 5, 4, 1, 0, 4, 3, 4, 0, 6, 3, 3, 4, 0, 2, 6, 3, 3, 5, 4, 5, 3, 1, 4, 4, 1, 5, 5, 3, 4, 2, 5, 2, 2, 3, 4, 2, 1, 3, 2, 2, 1, 1, 1, 1, 3, 0, 0, 1, 0, 1, 1, 0, 0, 3, 1, 0, 3, 2, 2, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 2, 1, 0, 0, 0, 1, 1, 0, 2, 3, 3, 1, 1, 2, 1, 1, 1, 1, 2, 3, 3, 0, 0, 0, 1, 4, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1)
year &lt;- 1851:1962
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">Rev</code> we specify this prior choice by</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eta ~ dnGamma(10.0,20.0)
beta ~ dnGamma(2.0,eta)
gamma ~ dnGamma(2.0,eta)
theta ~ dnUnif(1852.0,1962.0)
</code></pre></div></div>

<p>Then we select moves for each parameter. For the rate parameters — which
are defined only on the positive real line — we choose a scaling move.
Only for ‘theta‘ we choose the sliding window proposal.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mi &lt;- 0
moves[mi++] = mvScale(eta)
moves[mi++] = mvScale(beta)
moves[mi++] = mvScale(gamma)
moves[mi++] = mvSlide(theta)
</code></pre></div></div>

<p>Then, we set up the model by computing the conditional rate of the
Poisson distribution, creating random variables for each observation and
attaching (clamping) data to the variables.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in 1:year.size() ) {
    rate[i] := ifelse(theta &gt; year[i], beta, gamma)
    y[i] ~ dnPoisson(rate[i])
    y[i].clamp(observed_fatalities[i])
}
</code></pre></div></div>

<p>Finally, we create the model object from the variables, add some
monitors and run the MCMC algorithm.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymodel = model( theta )

monitors[1] = mnModel(filename="output/coal_accidents.log",printgen=10, separator = "	")
monitors[2] = mnScreen(printgen=10, eta, lambda, gamma, theta)

mymcmc = mcmc(mymodel, monitors, moves)

mymcmc.run(generations=3000)
</code></pre></div></div>

<h2 id="batch-mode">Batch Mode</h2>

<p>If you wish to run this exercise in batch mode, the files are provided
for you.</p>

<p>You can carry out these batch commands by providing the file name when
you execute the ‘rb‘ binary in your unix terminal (this will overwrite
all of your existing run files).</p>

<div class="language-plaintext bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rb RevBayes_scripts airline_fatalities_part1.Rev
rb RevBayes_scripts airline_fatalities_part2.Rev
rb RevBayes_scripts coalmine_accidents.Rev
</code></pre></div></div>

<ol class="bibliography"><li><span id="Gelman2003">Gelman A., Carlin J.B., Stern H.S., Rubin D.B. 2003. Bayesian Data Analysis. Chapman &amp; Hall/CRC.</span>

</li>
<li><span id="Rambaut2011">Rambaut A., Drummond A.J. 2011. Tracer v1.5. .</span>


<a href="http://tree.bio.ed.ac.uk/software/tracer/">http://tree.bio.ed.ac.uk/software/tracer/</a>
</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
    });
    MathJax.Hub.Queue(function () {
      $(".aside").each(function() {
          $("div .MathJax", this).hide();
      });
    });
</script>
<script src="/assets/js/base.js"></script>

  </body>
</html>
