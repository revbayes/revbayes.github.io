<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Introduction to Discrete Morphology Evolution</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/download">Download</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/documentation/">Documentation</a></li>
        <li><a href="/interfaces">Interfaces</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
        <li><class="header-search">
  <form class="header-search-form" action="/search.html" method="get">
    <input type="text" id="search-box-nav" placeholder="Search..." name="query" style="border-color:black;background-color:white;height:32px;">
    <button type="submit" style="color:black; border-color:black;width:32px;height:32px;padding-top:4px">
        <img src="assets/img/search.png" height="22px" width="28px"/>
    </button>
  </form>
</div>

</li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Introduction to Discrete Morphology Evolution</h1>
	<h3 class="subtitle">Overview of types of Analyses</h3>
	<h4 class="authors">Sebastian Höhna</h4>
  <h5>Last modified on November 29, 2022</h5>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/intro/">Getting Started with RevBayes and Rev Language Syntax</a></li>
          
            <li><a href="/tutorials/mcmc/">Introduction to Markov chain Monte Carlo (MCMC) Sampling</a></li>
          
            <li><a href="/tutorials/ctmc/">Nucleotide substitution models</a></li>
          
            <li><a href="/tutorials/morph_tree/">Discrete morphology - Tree Inference</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





<blockquote class="tutorial_files" id="tutorial_files">
    <h2>Data files and scripts</h2>
    
        
        <strong>Data Files</strong>
        <ul id="data_files">
        
        
        
          <li><a href="/tutorials/morph_ase/data/primates_activity_period.nex">primates_activity_period.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_diet.nex">primates_diet.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_habitat.nex">primates_habitat.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_males.nex">primates_males.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_mating_system.nex">primates_mating_system.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_morph.nex">primates_morph.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_morph_description.txt">primates_morph_description.txt</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_solitariness.nex">primates_solitariness.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_terrestrially.nex">primates_terrestrially.nex</a></li>
        
          <li><a href="/tutorials/morph_ase/data/primates_tree.nex">primates_tree.nex</a></li>
        
        </ul>
    
</blockquote>


</div>
<h2 class="section" id="introduction">Introduction</h2>
<hr class="section" />

<p>Discrete morphological models are not only useful for tree estimation,
as was done in Tutorial <a href="/tutorials/morph_tree/">Discrete morphology - Tree Inference</a>, but also to ask specific questions about the evolution of the morphological character of interest.
Specifically, there are a few types of analyses that we might be interest in.
First, we can test different models of morphological evolution,
such as reversible and irreversible models, and estimate rates under these models.
For example, using an irreversible model of evolution, we can test, for example,
for Dollo’s law of a complex character that can be lost but not gained again <a class="citation" href="#Goldberg2008">(Goldberg and Igić 2008)</a>.</p>

<p>Additionally, we might be interest in ancestral state estimation,
or mapping transition on the phylogeny.
Commonly the central problem in statistical phylogenetics concerns <em>marginalizing</em> over all unobserved character histories that evolved along the branches of a given phylogenetic tree according to some model, $M$, under some parameters, $\theta$.
This marginalization yields the probability of observing the tip states, $X_\text{tip}$,
given the model and its parameters,
$P( X_\text{tip} | \theta, M ) = \sum_{X_\text{internal}} P( X_\text{internal}, X_\text{tip} \mid \theta, M )$.
One might also wish to find the probability distribution of ancestral state
configurations that are consistent with the tip state distribution,
$P( X_\text{internal} \mid X_\text{tip}, \theta, M )$, and to sample
ancestral states from that distribution.
This procedure is known as <em>ancestral state estimation</em>.</p>

<p>%Finally, we might be interested in testing for correlated evolution between discrete morphological characters.
%For example,
%
This tutorial will provide a discussion of modeling morphological characters
and ancestral state estimation, and will demonstrate how to perform such
Bayesian phylogenetic analysis using RevBayes <a class="citation" href="#Hoehna2016b">(Höhna et al. 2016)</a>.</p>

<h3 id="the-data">The data</h3>

<blockquote class="instruction">
  <p>Create a directory on your computer for this tutorial.
In this directory, create a subdirectory called <strong>data</strong>, and download the data files that you can find on the left of this page.</p>
</blockquote>

<p>We have taken the phylogeny from <a class="citation" href="#MagnusonFord2012">Magnuson-Ford and Otto (2012)</a>, who took it from <a class="citation" href="#Vos2006">Vos and Mooers (2006)</a> and then randomly resolved the polytomies using the method of <a class="citation" href="#Kuhn2011">Kuhn et al. (2011)</a> and the trait data from <a class="citation" href="#Redding2010">Redding et al. (2010)</a>. In the <strong>data</strong> folder, you should now have the following files:</p>

<ul>
  <li><a href="data/primates_tree.nex">primates_tree.nex</a>:
Dated primate phylogeny including 233 out of 367 species.</li>
  <li><a href="data/primates_activity_period.nex">primates_activity_period.nex</a>:
A file with the coded character states for primate species activity time. This character has just two states: <code class="language-plaintext highlighter-rouge">0</code> = diurnal and <code class="language-plaintext highlighter-rouge">1</code> = nocturnal.</li>
  <li><a href="data/primates_habitat.nex">primates_habitat.nex</a>:
A file with the coded character states for primate species habitay. This character has just two states: <code class="language-plaintext highlighter-rouge">0</code> = forest and <code class="language-plaintext highlighter-rouge">1</code> = savanna.</li>
  <li><a href="data/primates_solitariness.nex">primates_solitariness.nex</a>:
A file with the coded character states for primate species social system type. This character has just two states: <code class="language-plaintext highlighter-rouge">0</code> = group living and <code class="language-plaintext highlighter-rouge">1</code> = solitary.</li>
  <li><a href="data/primates_terrestrially.nex">primates_terrestrially.nex</a>:
A file with the coded character states for primate species terrestrially. This character has just two states: <code class="language-plaintext highlighter-rouge">0</code> = arboreal and <code class="language-plaintext highlighter-rouge">1</code> = terrestrial.</li>
  <li><a href="data/primates_males.nex">primates_males.nex</a>:
A file with the coded character states for the number of males within a group per primate species. This character has four states: <code class="language-plaintext highlighter-rouge">0</code> = single male, <code class="language-plaintext highlighter-rouge">1</code> = single and multi male, and <code class="language-plaintext highlighter-rouge">2</code> = multi male.</li>
  <li><a href="data/primates_mating_system.nex">primates_mating_system.nex</a>:
A file with the coded character states for primate species mating-system type. This character has four states: <code class="language-plaintext highlighter-rouge">0</code> = monogamy, <code class="language-plaintext highlighter-rouge">1</code> = polygyny, <code class="language-plaintext highlighter-rouge">2</code> = polygynandry, and <code class="language-plaintext highlighter-rouge">3</code> = polyandry.</li>
  <li><a href="data/primates_diet.nex">primates_diet.nex</a>:
A file with the coded character states for primate species diet. This character has six states: <code class="language-plaintext highlighter-rouge">0</code> = frugivore, <code class="language-plaintext highlighter-rouge">1</code> = insectivore, <code class="language-plaintext highlighter-rouge">2</code> = folivore, <code class="language-plaintext highlighter-rouge">3</code> = gummnivore, <code class="language-plaintext highlighter-rouge">4</code> = omnivore, and <code class="language-plaintext highlighter-rouge">5</code> = gramnivore.</li>
</ul>

<figure id="fig_fbdr_gm"><p><img src="figures/Primates_traits.png" width="500pt" /></p>
<figcaption>Primate phylogeny with traits displayed at the tips from <a class="citation" href="#MagnusonFord2012">Magnuson-Ford and Otto (2012)</a>.</figcaption>
</figure>

<h3 id="scripts">Scripts</h3>

<p>For more complex models and analyses, it’s useful to create separate Rev scripts that contain all the model parameters, moves, and functions for different model components (e.g. the substitution model and the clock model).</p>

<blockquote class="instruction">
  <p>Create another subdirectory called <strong>scripts</strong>.</p>
</blockquote>

<p>In this tutorial, you will work primarily in your text editor and create a script file that can be easily managed and modified. Examples of all the commands used to perform each analysis are also provided at the top of this page under <strong>Scripts</strong> but try to write the complete scripts yourself from the beginning to ensure you understand all the steps involved and the differences between setting up each analysis.</p>

<h3 id="exercises">Exercises</h3>

<blockquote class="instruction">
  <p>Click on the first exercise to begin!</p>
</blockquote>

<ol>
  <li><a href="/tutorials/morph_ase/ase">Ancestral state estimation</a></li>
  <li><a href="/tutorials/morph_ase/ase_free">Testing for independent rates</a></li>
  <li><a href="/tutorials/morph_ase/ase_irreversible">Testing for irreversibility</a></li>
  <li><a href="/tutorials/morph_ase/scm_hrm">Stochastic Character Mapping and Testing for Rate Variation</a></li>
  <li><a href="/tutorials/morph_ase/corr">Testing for Correlation between Characters</a></li>
</ol>

<ol class="bibliography"><li><span id="Goldberg2008">Goldberg E.E., Igić B. 2008. On Phylogenetic Tests of Irreversible Evolution. Evolution. 62:2727–2741.</span>

<a href="https://doi.org/10.1111/j.1558-5646.2008.00505.x">10.1111/j.1558-5646.2008.00505.x</a>

</li>
<li><span id="Hoehna2016b">Höhna S., Landis M.J., Heath T.A., Boussau B., Lartillot N., Moore B.R., Huelsenbeck J.P., Ronquist F. 2016. RevBayes: Bayesian Phylogenetic Inference Using Graphical Models and an Interactive Model-Specification Language. Systematic Biology. 65:726–736.</span>

<a href="https://doi.org/10.1093/sysbio/syw021">10.1093/sysbio/syw021</a>

</li>
<li><span id="Kuhn2011">Kuhn T.S., Mooers A.Ø., Thomas G.H. 2011. A Simple Polytomy Resolver for Dated Phylogenies. Methods in Ecology and Evolution. 2:427–436.</span>

<a href="https://doi.org/10.1111/j.2041-210X.2011.00103.x">10.1111/j.2041-210X.2011.00103.x</a>

</li>
<li><span id="MagnusonFord2012">Magnuson-Ford K., Otto S.P. 2012. Linking the Investigations of Character Evolution and Species Diversification. The American Naturalist. 180:225–245.</span>

<a href="https://doi.org/10.1086/666649">10.1086/666649</a>

</li>
<li><span id="Redding2010">Redding D.W., DeWolff C.V., Mooers A.Ø. 2010. Evolutionary Distinctiveness, Threat Status, and Ecological Oddity in Primates. Conservation Biology. 24:1052–1058.</span>

</li>
<li><span id="Vos2006">Vos R.A., Mooers A.Ø. 2006. A New Dated Supertree of the Primates. .</span>

</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
    });
    MathJax.Hub.Queue(function () {
      $(".aside").each(function() {
          $("div .MathJax", this).hide();
      });
    });
</script>
<script src="/assets/js/base.js"></script>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0Y03X9Q2TJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0Y03X9Q2TJ');
</script>

  </body>
</html>
