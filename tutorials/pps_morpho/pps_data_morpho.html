<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Assessing Phylogenetic Reliability Using RevBayes and $P^{3}$</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/download">Download</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/documentation/">Documentation</a></li>
        <li><a href="/interfaces">Interfaces</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Assessing Phylogenetic Reliability Using RevBayes and $P^{3}$</h1>
	<h3 class="subtitle">Model adequacy testing using posterior prediction (Morphological Models).</h3>
	<h4 class="authors">Laura Mulvey</h4>
  <h5>Last modified on January 19, 2024</h5>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/intro/">Getting Started with RevBayes and Rev Language Syntax</a></li>
          
            <li><a href="/tutorials/mcmc/">Introduction to Markov chain Monte Carlo (MCMC) Sampling</a></li>
          
            <li><a href="/tutorials/morph_tree/">Discrete morphology - Tree Inference</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





<blockquote class="tutorial_files" id="tutorial_files">
    <h2>Data files and scripts</h2>
    
        
        <strong>Data Files</strong>
        <ul id="data_files">
        
        
        
          <li><a href="/tutorials/pps_morpho/data/Egi_etal_2005.nex">Egi_etal_2005.nex</a></li>
        
        </ul>
    
        
        <strong>Scripts</strong>
        <ul id="scripts">
        
        
        
          <li><a href="/tutorials/pps_morpho/scripts/MkVP+G_Model.Rev">MkVP+G_Model.Rev</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/Mk_Model.Rev">Mk_Model.Rev</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/Test-stats.r">Test-stats.r</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/pps_MCMC.Rev">pps_MCMC.Rev</a></li>
        
          <li><a href="/tutorials/model_testing_pps/scripts/pps_Simulation.Rev">pps_Simulation.Rev</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/pps_Simulation.Rev">pps_Simulation.Rev</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/pps_analysis_Mk.Rev">pps_analysis_Mk.Rev</a></li>
        
          <li><a href="/tutorials/pps_morpho/scripts/pps_analysis_MkVP+G.Rev">pps_analysis_MkVP+G.Rev</a></li>
        
        </ul>
    
</blockquote>


</div>
<h2 class="section" id="overview">Overview</h2>
<hr class="section" />

<p>This tutorial presents a general approach for using posterior predictive
simulations (PPS) to determine the adequacy of morphological substitution models. PPS
assess the reliability of an evolutionary model for a given data set through the use
of simulations and a number of test statistics. In this way, it is possible to determine
whether a model is adequately capturing the evolutionary dynamics of the data set or
not.</p>

<h2 class="section" id="introduction">Introduction</h2>
<hr class="section" />

<p>Understanding morphological evolution is an extremely difficult task. Within
palaeobiology there are a small number of relatively simple evolutionary models to
describe this complex process. Assessing the fit of these models to individual data
sets is therefore crucial in order to have confidence in the inference results. 
Posterior prediction is a Bayesian approach to assess the fit of a model to a given
data set <a class="citation" href="#Bollback2002">(Bollback 2002; Brown 2014; Höhna et al. 2018)</a>. PPS works by 
simulating data sets based on parameters sampled from the posterior distribution,
(<a href="#pps_schematic"></a>) . If the simulated data is found to be similar to the
empirical data, according to the chosen test statistics, you can have
confidence that the model is capturing the properties of the empirical data 
and can be used for an analysis. In this way, PPS provides the absolute fit of an
evolutionary model to a given data set.</p>

<p>In this tutorial, we will walk through how to use PPS to detemine the fit of a model
to a data set of Hyaenodontidae taken from (missing reference)
We will test two models in this tutorial. Each test is completely seperate from
the other as we are determining the absolute fit of the model to the data set.</p>

<figure id="pps_schematic"><p><img src="figures/pps-morpho.png" /></p>
<figcaption>A schematic presentation of Posterior predictive simulation for morphological
substitution models. Step 1 involves a carrying out an inference under the model of
interest. Step 2 a number of data sets are then simulated using parameters taken from
the posterior distribution estimated in step 1. Step 3 uses tests statistics to assess
how similar the simulated data sets are to the empirical. The test statistic employed
here are consistency index and retention index. P-values or effect sizes can be used
to determine whether a model is adequate or not for a given data set.</figcaption>
</figure>

<h3 class="subsection" id="substitution-models">Substitution Models</h3>
<hr class="subsection" />

<p>The models used here are described in more detail in the tutorial  <a href="/tutorials/morph_tree/">Discrete morphology - Tree Inference</a>. For a better understanding of the assumptions of these models, consult
the previous tutorial. We provide scripts for two subsitution models here:</p>

<ul>
  <li>
    <p>Mk substitution model <a class="citation" href="#Lewis2001">(Lewis 2001)</a></p>
  </li>
  <li>
    <p>MkVP+G substitution model <a class="citation" href="#Lewis2001">(Lewis 2001)</a></p>
  </li>
</ul>

<h2 class="section" id="assessing-model-fit-with-posterior-prediction">Assessing Model Fit with Posterior Prediction</h2>
<hr class="section" />

<p>Here we will highlight the main parts of the analysis. The morpholgoical data used here is of Proviverrine hyaenodontids from (missing reference). The data set contains 15 taxa, 65 characters with 5 character states. To quickly run the entire PPS pipeline
you can run the <strong>pps_analysis_Mk.Rev</strong> script. To run this type the following command into
<code class="language-plaintext highlighter-rouge">RevBayes</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    source("scripts/pps_analysis_Mk.Rev")
</code></pre></div></div>

<p>The test statistics and P-values can then be calculated by running the <code class="language-plaintext highlighter-rouge">Test-stats.r </code> scripts in r studio.</p>

<h3 class="subsection" id="empirical-mcmc-analysis">Empirical MCMC Analysis</h3>
<hr class="subsection" />

<p>The initial step in PPS involves generating a posterior distribution from which we
will later sample from, in order to simulated new data sets. 
Here we will specify our dataset, evolutionary model, and run a normal MCMC analysis.
This code is in the <strong>pps_analysis_Mk.rev</strong> script.</p>

<h4 class="subsubsection" id="set-up-the-workspace">Set up the workspace</h4>
<hr class="subsubsection" />

<p>First, let’s set up some workspace variables we’ll need, and define which substitution
model we will use for the analysis, either Mk or MkVP+G.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    analysis_name = "pps_morpho_example"
    model_name = "Mk"
    model_file_name = "scripts/pps_"+model_name+"_Model.Rev"
</code></pre></div></div>

<p>Next specify and read in the data file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    inFile = "data/Egi_etal_2005.nex"
    morpho &lt;- readDiscreteCharacterData(inFile)
</code></pre></div></div>

<div class="language-plaintext Rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Successfully read one character matrix from file data/Egi_etal_2005.nex"
</code></pre></div></div>

<p>Specify the maximum number of states in the morphological alignment. For morphological data
sets this value will change depending on the data set. We need this to construct the 
Q-matrix of the correct size.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    num_states ="5"
</code></pre></div></div>

<p>Create vectors to store your moves and monitors for the analysis</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>moves    = VectorMoves()
monitors = VectorMonitors()
</code></pre></div></div>

<p>For the rest of the tutorial you can choose to either use the <code class="language-plaintext highlighter-rouge">source()</code> function to run the scripts <strong>or</strong> copy and paste the each line into revbayes as they are explained.</p>

<h4 class="subsubsection" id="specifying-the-model">Specifying the model</h4>
<hr class="subsubsection" />

<p>Here we will specify both the tree model and the substitution model. 
Typing the following command into <code class="language-plaintext highlighter-rouge">RevBayes</code> will run the model script.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source( model_file_name )
</code></pre></div></div>
<div class="language-plaintext Rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Processing file "scripts/Mk_Model.Rev"
    Processing of file "scripts/Mk_Model.Rev" completed 
</code></pre></div></div>
<p>Opening the model file, we can see how we have set it up.</p>

<p>The first part of the file specifies the tree model.
We put a prior on the branch lengths using an exponential distribution with a rate 0.2</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>br_len_lambda ~ dnExp(0.2)
moves.append(mvScale(br_len_lambda, weight=2))
</code></pre></div></div>

<p>We then set a uniform tree prior for the tree topology. This prior assumes that no tree is 
more likely <em>a priori</em> than any other.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phylogeny ~ dnUniformTopologyBranchLength(taxa, branchLengthDistribution=dnExponential(br_len_lambda))
moves.append(mvNNI(phylogeny, weight=num_branches/2.0))
moves.append(mvSPR(phylogeny, weight=num_branches/10.0))
moves.append(mvBranchLengthScale(phylogeny, weight=num_branches))
tree_length := phylogeny.treeLength()
</code></pre></div></div>

<p>In this script we are specifying an Mk model, where K is the maximum number of
observed states. As the Mk model is a generalization of the JC model this is done using the 
<code class="language-plaintext highlighter-rouge">fnJC()</code> function. This creates a Q-matrix of size <code class="language-plaintext highlighter-rouge">num_states</code>. The resulting Q-matrix 
will have equal transition probabilities between all states.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q := fnJC(int(num_states)) 
</code></pre></div></div>
<p>We then create <code class="language-plaintext highlighter-rouge">PhyloCTMC object</code>. This joins all the model parameters we created to model
the morphological data. The is then clamped to the sequence evolution model.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seq ~ dnPhyloCTMC(tree=phylogeny, Q=Q, type="Standard")
seq.clamp(morpho)
</code></pre></div></div>

<p>Finally, we can create a workspace model variable using the <code class="language-plaintext highlighter-rouge">model()</code>function. We provide 
the model function a single node here using (<code class="language-plaintext highlighter-rouge">phylogeny</code>).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymodel = model(phylogeny)
</code></pre></div></div>

<h4 class="subsubsection" id="run-the-mcmc">Run the MCMC</h4>
<hr class="subsubsection" />

<p>To run the analysis, we need to set up the MCMC. As with the previous scripts you can run this by typing the following command in <code class="language-plaintext highlighter-rouge">RevBayes</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source("scripts/pps_MCMC.Rev")
</code></pre></div></div>
<p>In this scripts, we are specifying the number of iterations, the monitors and the burn.
For this analysis we add a different file then the normal set up, the <code class="language-plaintext highlighter-rouge">.var</code> file. This file 
will be used in the next step to simulate the new data sets.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>monitors.append( mnModel(filename="output_" + model_name + "/" + analysis_name + "_posterior.log",printgen=10, separator = TAB)) 
monitors.append( mnFile(filename="output_" + model_name + "/" + analysis_name + "_posterior.trees",printgen=10, separator = TAB, phylogeny) )
monitors.append( mnScreen(printgen=1000, tree_length) )
monitors.append( mnStochasticVariable(filename="output_" + model_name + "/" + analysis_name + "_posterior.var",printgen=10) )
</code></pre></div></div>

<p>Now that we have our model, moves, and monitors set up we can define our MCMC. This is done 
using <code class="language-plaintext highlighter-rouge">mcmc()</code> function.<code class="language-plaintext highlighter-rouge">nruns</code>specifiies that there are two independent mcmc runs during the analysis.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine="mixed")
mymcmc.burnin(generations=200,tuningInterval=200)
</code></pre></div></div>
<div class="language-plaintext Rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Running burn-in phase of Monte Carlo sampler for 200 iterations.
   This simulation runs 2 independent replicates.
   The simulator uses 4 different moves in a random move schedule with 30.7 moves per iteration
   

Progress:
0---------------25---------------50---------------75--------------100
********************************************************************
</code></pre></div></div>

<p>To start the MCMC then run the following command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mymcmc.run(generations=10000,tuningInterval=200)
</code></pre></div></div>

<div class="language-plaintext Rev-output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Running MCMC simulation
   This simulation runs 2 independent replicates.
   The simulator uses 4 different moves in a random move schedule with 30.7 moves per iteration
   

Iter        |      Posterior   |     Likelihood   |          Prior   |    tree_length   |    elapsed   |        ETA   |
-----------------------------------------------------------------------------------------------------------------------
0           |       -996.887   |        -1026.4   |        29.5141   |       5.267817   |   00:00:00   |   --:--:--   |
1000        |       -991.783   |       -1020.93   |        29.1461   |       5.635822   |   00:00:05   |   --:--:--   |
2000        |        -993.55   |       -1023.25   |        29.7004   |       5.081564   |   00:00:11   |   00:00:44   |
3000        |       -984.413   |       -1014.64   |        30.2221   |       4.559854   |   00:00:16   |   00:00:37   |
4000        |       -986.254   |       -1016.16   |        29.9079   |       4.874004   |   00:00:22   |   00:00:33   |
</code></pre></div></div>

<p>Once the analysis is finished you can generate a most credible clade summary tree using the <code class="language-plaintext highlighter-rouge">mccTree()</code> function.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trace = readTreeTrace("output_" + model_name + "/" + analysis_name + "_posterior.trees")
mccTree(trace, file="output_" + model_name + "/MCC.tre")
</code></pre></div></div>

<h4 class="subsubsection" id="mcmc-output">MCMC output</h4>
<hr class="subsubsection" />

<p>As output from the analysis, you should have folder named <em>output_Mk</em> in your current directory. This file contains the 
log files and trees from both runs and a combination of both. You should use programs like Tracer to check for 
convergence at this stage.</p>

<p>Before moving on to the next section it is important to clear the <code class="language-plaintext highlighter-rouge">RevBayes</code> environment of all the variables created 
during the previous step. This can be done using the following <code class="language-plaintext highlighter-rouge">clear()</code>function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>clear()
</code></pre></div></div>

<h3 class="subsection" id="posterior-predictive-data-simulation">Posterior Predictive Data Simulation</h3>
<hr class="subsection" />

<p>In this section we will simulate new data sets based on the parameters sampled in the <code class="language-plaintext highlighter-rouge">.var</code>file in part one of this 
tutorial.</p>

<p>We first have to load the data and set up the model as we did in the previous step. As we went through this above you 
can simply copy and paste this into the terminal.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>inFile = "data/Egi_etal_2005.nex"
analysis_name = "pps_morpho_example"
morpho &lt;- readDiscreteCharacterData(inFile)
model_name = "Mk"
num_states ="5"
source( model_file_name )
</code></pre></div></div>

<p>The scripts <strong>pps_Simulation.Rev</strong> contains the code to simulate new data.</p>

<p>First we read in the trace file created during the previous MCMC.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trace = readStochasticVariableTrace("output_" + model_name + "/" + analysis_name + "_posterior.var", delimiter=TAB)
</code></pre></div></div>

<p>Now we use the <code class="language-plaintext highlighter-rouge">posdteriorPredictiveSimulation()</code> function to set up the simulations. We provide the function with the
 model, and output directory and the trace file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pps = posteriorPredictiveSimulation(mymodel, directory="output_" + model_name + "/" + analysis_name + "_post_sims", trace)
</code></pre></div></div>

<p>To start the simulation we use the <code class="language-plaintext highlighter-rouge">pps.run()</code>function. Here we can specify how many data sets we want to simulate by 
setting the thinning. The <code class="language-plaintext highlighter-rouge">.var</code>file` contains a number of phylogenetic trees. If thinning is set to the default (0) the 
pps.run() function will simulate data for each tree. Setting thinning to 2 will simulate along every second tree and so 
on. In this way setting thinning = 2 simulates data for half of the trees in the .var file. Simulating 500 data 
sets has been found to be sufficient for these types of analysis. If you increase the number of iterations in the MCMC 
you may want to increase the thinning value here. Here we set thinning to 4.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pps.run(thinning=4)
</code></pre></div></div>

<p>Once you run this command a file should be created in the <em>output_Mk</em> directory called <em>pps_morpho_example_post_sims</em>.
This is where all of the data simulated in revbayes will be stored. This simulation step should only take a few minutes.</p>

<h3 class="subsection" id="calculating-the-p-values-and-effect-sizes-for-the-test-statistics">Calculating the <em>P</em>-values and effect sizes for the Test Statistics</h3>
<hr class="subsection" />

<p>To determine if a model is adequate or not we need to compare the empirical data with the newly simulated data sets. If 
the simulated data sets are not significantly different from the empirical, we can conclude that the model is adequate 
for the data set. Here we use two test statistics, <strong>Consistency Index</strong> and <strong>Retention Index</strong>.
Consistency Index is a measure of homoplasy in the data and retention index measures the number of synapomorphies. These 
test statistics are calculated in <code class="language-plaintext highlighter-rouge">R</code> using the <strong>Test-stats.r</strong> script.</p>

<p>This script calculates posterior p-values and effect sizes to determine the adequacy of the model. Here we calculate 4
p-values, lower 1-tailed, Upper 1-tailed, 2-tailed, and the mid-point p-value. Values of less than 0.25 or greater the 
0.975 indicate significance. The effect sizes can also be used to determine the adequacy of a model, though the p-values 
are considered more conservative. For the effect sizes, if the maximum and minimum value range through zero a model can 
be considered adequate.</p>

<h4 class="subsubsection" id="visualising-the-results">Visualising the results</h4>
<hr class="subsubsection" />

<figure id="pps_schematic"><p><img src="figures/Ma_results.png" /></p>
<figcaption>Histrograms show the distribution of values calculated for each test statistic from the simulated data sets. The green 
line shows the empirical value while the blue shows the median simulated value. The box plots show the effect sizes 
calculated for the test statistics. The median value should be closer to zero, models are considered adequate if the 
min and max values are range through zero.</figcaption>
</figure>

<p>The Mk model would not be considered accurate for this data set. While it does well according to the retention index, 
the consistency index determined the simulated data to be significantly different to the empirical.</p>

<h2 class="section" id="additional-exercise">Additional Exercise</h2>
<hr class="section" />

<p>Now that you know the Mk model is not appropriate for the data set try the MKVP+G model. Is this model better? Use the 
following command to rerun the entire analysis using the other model.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source("scripts/pps_analysis_MkVP+G")
</code></pre></div></div>

<ol class="bibliography"><li><span id="Bollback2002">Bollback J.P. 2002. Bayesian model adequacy and choice in phylogenetics. Molecular Biology and Evolution. 19:1171–1180.</span>

<a href="https://doi.org/10.1093/oxfordjournals.molbev.a004175">10.1093/oxfordjournals.molbev.a004175</a>

</li>
<li><span id="Brown2014">Brown J.M. 2014. Predictive approaches to assessing the fit of evolutionary models. Systematic Biology. 63:289–292.</span>

<a href="https://doi.org/10.1093/sysbio/syu009">10.1093/sysbio/syu009</a>

</li>
<li><span id="Hoehna2018a">Höhna S., Coghill L.M., Mount G.G., Thomson R.C., Brown J.M. 2018. P^3: Phylogenetic Posterior Prediction in RevBayes. Molecular Biology and Evolution. 35:1028–1034.</span>

<a href="https://doi.org/10.1093/molbev/msx286">10.1093/molbev/msx286</a>

</li>
<li><span id="Lewis2001">Lewis P.O. 2001. A Likelihood Approach to Estimating Phylogeny from Discrete Morphological Character Data. Systematic Biology. 50:913–925.</span>

<a href="https://doi.org/10.1080/106351501753462876">10.1080/106351501753462876</a>

</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
    });
    MathJax.Hub.Queue(function () {
      $(".aside").each(function() {
          $("div .MathJax", this).hide();
      });
    });
</script>
<script src="/assets/js/base.js"></script>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0Y03X9Q2TJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0Y03X9Q2TJ');
</script>

  </body>
</html>
