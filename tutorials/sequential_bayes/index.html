<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Sequential Bayesian inference of phylogeny</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/download">Download</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/documentation/">Documentation</a></li>
        <li><a href="/interfaces">Interfaces</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Sequential Bayesian inference of phylogeny</h1>
	<h3 class="subtitle">Example sequential Bayesian analysis for divergence time estimation in RevBayes</h3>
	<h4 class="authors">Sebastian Höhna</h4>
  <h5>Last modified on June  7, 2024</h5>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/intro/">Getting Started with RevBayes and Rev Language Syntax</a></li>
          
            <li><a href="/tutorials/mcmc/">Introduction to Markov chain Monte Carlo (MCMC) Sampling</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





<blockquote class="tutorial_files" id="tutorial_files">
    <h2>Data files and scripts</h2>
    
        
        <strong>Data Files</strong>
        <ul id="data_files">
        
        
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_16S.fas">photinus_16S.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_18S.fas">photinus_18S.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_28S.fas">photinus_28S.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_CAD.fas">photinus_CAD.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_COI.fas">photinus_COI.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_UV_opsin.fas">photinus_UV_opsin.fas</a></li>
        
          <li><a href="/tutorials/sequential_bayes/data/photinus_WG.fas">photinus_WG.fas</a></li>
        
        </ul>
    
        
        <strong>Scripts</strong>
        <ul id="scripts">
        
        
        
          <li><a href="/tutorials/sequential_bayes/scripts/check_convergence_unrooted.R">check_convergence_unrooted.R</a></li>
        
          <li><a href="/tutorials/sequential_bayes/scripts/mcmc_ultrametric_single_gene.Rev">mcmc_ultrametric_single_gene.Rev</a></li>
        
          <li><a href="/tutorials/sequential_bayes/scripts/plot_ultrametric_MAP_trees.R">plot_ultrametric_MAP_trees.R</a></li>
        
          <li><a href="/tutorials/sequential_bayes/scripts/plot_unrooted_MAP_trees.R">plot_unrooted_MAP_trees.R</a></li>
        
        </ul>
    
</blockquote>


</div>
<h1 class="section" id="overview">Overview</h1>

<p>This tutorial aims to guide you through our sequential (or stepwise) Bayesian inference pipeline using <a href="http://revbayes.com">RevBayes</a> <a class="citation" href="#Hoehna2024">(Höhna and Hsiang 2024)</a>. The exercises are based on a dataset of North American fireflies (genus <em>Photinus</em>) for which we have molecular sequence data for extant species <a class="citation" href="#Catalan2022">(Catalan et al. 2022)</a>. Our goal is to estimate a time-calibrated phylogeny using a relaxed clock model. The two steps in our sequential Bayesian analysis are first to estimate the posterior distribution of phylogenies with branch lengths, and second to use these samples to infer a time-calibrated phylogeny.</p>

<p>In <a href="/tutorials/sequential_bayes/unrooted_gene_trees">exercises 1</a> we’ll use the molecular sequence data to infer the relationships among living species.
In <a href="/tutorials/sequential_bayes/stepwise_dating">exercise 2</a> we transform the branch lengths from units of substitution into units of time assuming a relaxed clock model.</p>

<h3 id="the-data">The data</h3>

<blockquote class="instruction">
  <p>Create a directory on your computer for this tutorial.
In this directory, create a subdirectory called <strong>data</strong>, and download the data files that you can find on the left of this page.</p>
</blockquote>

<p>In the <strong>data</strong> folder, you should now have seven files.
Each file is a <em>fasta</em> formatted alignment of a different protein coding gene.
In the tutorial we are only going to use a single gene, COI, but as an exercise you should repeat the analysis with another gene and also with all genes concatenated together as a partitioned analysis.</p>

<h3 id="scripts">Scripts</h3>

<p>For more complex models and analyses, it’s useful to create separate Rev scripts that contain all the model parameters, moves, and functions for different model components (e.g., the substitution model and the clock model).</p>

<blockquote class="instruction">
  <p>Create another subdirectory called <strong>scripts</strong>.</p>
</blockquote>

<p>In this tutorial, you will work primarily in your text editor and create a set of modular files that can be easily managed and interchanged. Examples of all the commands used to perform each analysis are also provided at the top of this page under <strong>scripts</strong> but try to write the complete scripts yourself from the beginning to ensure you understand all the steps involved and the differences between setting up each analysis.</p>

<h3 id="exercises">Exercises</h3>

<blockquote class="instruction">
  <p>Click on the first exercise to begin!</p>
</blockquote>

<ol>
  <li><a href="/tutorials/sequential_bayes/unrooted_gene_trees">Estimating unrooted gene tree(s)</a></li>
  <li><a href="/tutorials/sequential_bayes/stepwise_dating">Rooting and time calibrating the gene tree(s)</a></li>
</ol>

<ol class="bibliography"><li><span id="Catalan2022">Catalan A., Höhna S., Lower S.E., Duchen P. 2022. Inferring the demographic history of the North American firefly Photinus pyralis. Journal of Evolutionary Biology. 35:1488–1499.</span>

</li>
<li><span id="Hoehna2024">Höhna S., Hsiang A.Y. 2024. Sequential Bayesian phylogenetic inference. Systematic Biology.:syae020.</span>

</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
    });
    MathJax.Hub.Queue(function () {
      $(".aside").each(function() {
          $("div .MathJax", this).hide();
      });
    });
</script>
<script src="/assets/js/base.js"></script>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0Y03X9Q2TJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0Y03X9Q2TJ');
</script>

  </body>
</html>
