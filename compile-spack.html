<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Compile with Spack</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/download">Download</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/documentation/">Documentation</a></li>
        <li><a href="/interfaces">Interfaces</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <h1 class="maintitle">

Compile with Spack

</h1>
<hr>

<h2 id="what-is-spack">What is Spack?</h2>

<p><a href="https://spack.readthedocs.io/en/latest/index.html">Spack</a> is a package management tool designed to support multiple versions and configurations of software on a wide variety of platforms and environments. It was designed for large supercomputing centers, where many users and application teams share common installations of software on clusters with exotic architectures, using libraries that do not have a standard ABI.</p>

<p>For RevBayes, it handles installing and linking the Boost and MPI dependencies for you. It also handles differences in the build process between versions.</p>

<h2 id="pre-requisites">Pre-requisites</h2>

<p>You will need to have C++ compiler installed on your computer, along with <code class="language-plaintext highlighter-rouge">git</code>, <code class="language-plaintext highlighter-rouge">make</code>, <code class="language-plaintext highlighter-rouge">curl</code>, and <code class="language-plaintext highlighter-rouge">python</code>. On OSX, <a href="https://apps.apple.com/us/app/xcode/id497799835?mt=12">XCode</a> is required.</p>

<h2 id="set-up">Set up</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/spack/spack.git
cd spack
source share/spack/setup-env.sh
spack compiler find
</code></pre></div></div>

<h2 id="compile-and-run">Compile and Run</h2>

<h3 id="latest-stable-version">Latest stable version</h3>

<h4 id="without-mpi">Without MPI</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack install revbayes ~mpi
spack load revbayes
rb
</code></pre></div></div>

<h4 id="with-mpi">With MPI</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack install revbayes +mpi
spack load revbayes
mpirun rb-mpi
</code></pre></div></div>

<h3 id="development-version">Development version</h3>

<h4 id="without-mpi-1">Without MPI</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack install revbayes@develop ~mpi
spack load revbayes
rb
</code></pre></div></div>

<h4 id="with-mpi-1">With MPI</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack install revbayes@develop +mpi
spack load revbayes
mpirun rb-mpi
</code></pre></div></div>

<h3 id="older-version">Older version</h3>

<p>You can install older versions by replacing <code class="language-plaintext highlighter-rouge">@develop</code> in the development version commands with <code class="language-plaintext highlighter-rouge">@version</code>. E.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack install revbayes@1.0.12 ~mpi.
</code></pre></div></div>

<p>To get a list of available versions run:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack info revbayes
</code></pre></div></div>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="error-revbayesdevelop-matches-multiple-packages">Error: revbayes@develop matches multiple packages.</h3>

<p>The error message should have a list of of packages like so:</p>

<pre>
Matching packages:
    abe2xnq revbayes@develop%gcc@9.2.1 arch=linux-fedora31-skylake
    l6sv4oz revbayes@develop%gcc@9.2.1 arch=linux-fedora31-skylake
</pre>

<p>The text before <code class="language-plaintext highlighter-rouge">revbayes</code> in each line is the hash for the package. You can get more information on the difference between the two packages by doing:</p>

<p>Package 1:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack find --deps /abe2xnq
</code></pre></div></div>

<p>Which shows</p>

<pre>
-- linux-fedora31-skylake / gcc@9.2.1 ---------------------------
revbayes@develop
    boost@1.72.0
        bzip2@1.0.8
        zlib@1.2.11
</pre>

<p>Package 2:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack find --deps /l6sv4oz
</code></pre></div></div>

<p>Which shows</p>

<pre>
==&gt; 1 installed package
-- linux-fedora31-skylake / gcc@9.2.1 ---------------------------
revbayes@develop
    boost@1.72.0
        bzip2@1.0.8
        zlib@1.2.11
    openmpi@3.1.5
        hwloc@1.11.11
            libpciaccess@0.13.5
            libxml2@2.9.9
                libiconv@1.16
                xz@5.2.4
            numactl@2.0.12
</pre>

<p>The difference here is that l6sv4oz was compiled with mpi support.</p>

<p>We can load it with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spack load /l6sv4oz
</code></pre></div></div>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "bash highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "bash highlighter-rouge";
//   }
//   
// });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
    });
    MathJax.Hub.Queue(function () {
      $(".aside").each(function() {
          $("div .MathJax", this).hide();
      });
    });
</script>
<script src="/assets/js/base.js"></script>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0Y03X9Q2TJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0Y03X9Q2TJ');
</script>

  </body>
</html>
